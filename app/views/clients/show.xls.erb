<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:html="http://www.w3.org/TR/REC-html40">
  <Worksheet ss:Name="Sheet1">
    <Table>
      <% if params[:export] == "behaviors" %>

        <Row>
          <Cell><Data ss:Type="String">Behavior ID</Data></Cell>
          <Cell><Data ss:Type="String">Description</Data></Cell>
          <Cell><Data ss:Type="String">Times Reported</Data></Cell>
          <Cell><Data ss:Type="String">Occurrences</Data></Cell>
          <Cell><Data ss:Type="String">Removed?</Data></Cell>
          <Cell><Data ss:Type="String">Updated On</Data></Cell>
        </Row>
        <% @client.behaviors.each do | behavior | %>
          <Row>
            <Cell><Data ss:Type="Number"><%= behavior.id %></Data></Cell>
            <Cell><Data ss:Type="String"><%= behavior.description %></Data></Cell>
            <Cell><Data ss:Type="Number"><%= behavior.report_count %></Data></Cell>
            <Cell><Data ss:Type="Number"><%= behavior.occurrence_count %></Data></Cell>
            <Cell><Data ss:Type="String"><%= behavior.removed ? "Yes" : "No" %></Data></Cell>
            <Cell><Data ss:Type="String"><%= behavior.updated_timestamp %></Data></Cell>
          </Row>
        <% end %>

      <% elsif params[:export] == "reports" %>

        <Row>
          <Cell><Data ss:Type="String">Behavior</Data></Cell>
          <Cell><Data ss:Type="String">Occurrences</Data></Cell>
          <Cell><Data ss:Type="String">Reported On</Data></Cell>
          <Cell><Data ss:Type="String">Removed?</Data></Cell>
          <Cell><Data ss:Type="String">Updated On</Data></Cell>
        </Row>
      
        <% @client.behavior_reports.each do | report | %>
          <Row>            
            <Cell><Data ss:Type="String"><%= report.behavior.description %></Data></Cell>
            <Cell><Data ss:Type="Number"><%= report.occurrences %></Data></Cell>
            <Cell><Data ss:Type="String"><%= report.timestamp %></Data></Cell>
            <Cell><Data ss:Type="String"><%= report.removed ? "Yes" : "No" %></Data></Cell>
            <Cell><Data ss:Type="String"><%= report.updated_timestamp %></Data></Cell>
          </Row>
        <% end %>

      <% end %>
    </Table>
  </Worksheet>
</Workbook>

